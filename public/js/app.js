!function i(a,s,u){function c(t,e){if(!s[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=s[t]={exports:{}};a[t][0].call(o.exports,function(e){return c(a[t][1][e]||e)},o,o.exports,i,a,s,u)}return s[t].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i,a=e("./Manager"),s=(i=a)&&i.__esModule?i:{default:i};var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,s.default),r(c,[{key:"toggleBusy",value:function(){this.settings.isBusy=!this.settings.isBusy}},{key:"defer",value:function(e,t,n){var r=this;setTimeout(function(){e.classList.toggle(r.settings.loadingClass),r.notify(t,n),r.toggleBusy()},this.settings.delay)}},{key:"setObservers",value:function(e){e.forEach(function(n){n.notifies.forEach(function(t){t.observers.forEach(function(e){n.instance.addObserver(t.name,e.instance,e.callback)})})})}},{key:"setEventHandlers",value:function(r){var o=this;window[this.settings.imgLoadFunc]=function(e){return o.imgLoadHandler(e)},window.onerror=function(e){return o.notify("showError",new Error(e))},document.getElementById(this.settings.appId).addEventListener("click",function(e){var t=e||window.event,n=t.target||t.srcElement;if("button"!==n.tagName.toLowerCase()||1==n.disabled)return!1;n.hasAttribute("data-download")&&o.itemsDownloadHandler(n,r),n.hasAttribute("data-delete")&&o.itemDelHandler(n)})}},{key:"imgLoadHandler",value:function(e){var t=this,n=e.getAttribute("data-image"),r=new Image;r.onload=function(){e.src=n,e.onload=null,e.removeAttribute("onload"),e.classList.toggle(t.settings.noImgClass),e.removeAttribute("data-image")},r.src=n}},{key:"itemDelHandler",value:function(e){if(this.settings.isBusy)return!1;this.toggleBusy(),e.classList.toggle(this.settings.loadingClass);var t={id:e.getAttribute("data-delete"),elem:e};this.defer(e,"removeElem",t)}},{key:"itemsDownloadHandler",value:function(e,t){if(this.settings.isBusy)return!1;this.toggleBusy(),e.classList.toggle(this.settings.loadingClass);var n=[].slice.call(document.getElementById(this.settings.itemsId).children).length;s.default.total>n&&(n+this.settings.perRow>=s.default.total&&e.setAttribute("disabled","disabled"),this.defer(e,"showMore",t.restore()))}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));return t.settings.isBusy=!1,t.settings.imgLoadFunc="lazyLoad",t.settings.noImgClass="no-image",t.settings.delay=500,t}n.default=u},{"./Manager":4}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,o=e("./Manager");var i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,((r=o)&&r.__esModule?r:{default:r}).default),a);function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.settings.url="http://81.177.101.143:30080/test.json",t}n.default=i},{"./Manager":4}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i,a=e("./LoadManager"),s=(i=a)&&i.__esModule?i:{default:i},u=e("./config");var c=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(l,s.default),r(l,[{key:"load",value:function(){var e=this;return new u.Promise(function(t,n){var r="jsonp_callback_"+Math.round(1e5*Math.random());window[r]=function(e){delete window[r],document.body.removeChild(o),t(e)};var o=document.createElement("script");o.src=e.settings.url+(~e.settings.url.indexOf("?")?"&":"?")+"callback="+r,document.body.appendChild(o),o.onerror=function(e){return n(e)}})}}]),l);function l(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,e));return t.settings.url="http://jsonplaceholder.typicode.com/photos",t}n.default=c},{"./LoadManager":2,"./config":10}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,o=e("./SubjectObserver");var i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,((r=o)&&r.__esModule?r:{default:r}).default),a);function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.settings={appId:"container",itemsId:"items",loadingClass:"loading",perRow:4},t}(n.default=i).total=0},{"./SubjectObserver":7}],5:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0});var o=(function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}(i,[{key:"add",value:function(e,t,n){Array.isArray(this.list[e])||(this.list[e]=[]),this.list[e].push({instance:t,callback:n})}}]),i);function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.list={}}n.default=o},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i,a=e("./Manager"),s=(i=a)&&i.__esModule?i:{default:i};var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,s.default),r(c,[{key:"removeItemId",value:function(e){~this.shownIds.indexOf(e.id)&&this.shownIds.splice(this.shownIds.indexOf(e.id),1)}},{key:"isAvailable",value:function(){try{var e=window[this.settings.storageType],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(e){return!1}}},{key:"isEmpty",value:function(){return!this.isAvailable()||!window[this.settings.storageType].getItem(this.settings.storageName)}},{key:"save",value:function(t){if(!t)return!1;if(!this.isAvailable())return this.data=t,!1;try{return window[this.settings.storageType].setItem(this.settings.storageName,JSON.stringify(t)),this.settings.storageName}catch(e){return this.data=t,!1}}},{key:"sort",value:function(e){var n=this;return e.slice(0).sort(function(e,t){return e[n.settings.sortProp]>t[n.settings.sortProp]?1:e[n.settings.sortProp]<t[n.settings.sortProp]?-1:0})}},{key:"paginate",value:function(e){var t=this,n=[],r=0;return e.every(function(e){return r!==t.settings.perRow&&t.shownIds.length!==s.default.total&&(~t.shownIds.indexOf(e.id)||(n.push(e),t.shownIds.push(e.id),r++),!0)}),n}},{key:"restore",value:function(){var e=this.data?this.data:JSON.parse(window[this.settings.storageType].getItem(this.settings.storageName));return s.default.total=e.length,this.paginate(this.sort(e))}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));return t.data=null,t.shownIds=[],t.settings.storageName="rostelecom",t.settings.storageType="sessionStorage",t.settings.sortProp="id",t}n.default=u},{"./Manager":4}],7:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0});var o=(function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}(i,[{key:"addObserver",value:function(e,t,n){this.observers.add(e,t,n)}},{key:"notify",value:function(e,t){this.observers.list[e].forEach(function(e){return e.instance.update(e.callback,t)})}},{key:"update",value:function(e,t){e.call(this,t)}}]),i);function i(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.observers=e}n.default=o},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i,a=e("./Manager"),s=(i=a)&&i.__esModule?i:{default:i},u=e("./config");var c=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(l,s.default),r(l,[{key:"ready",value:function(){return new u.Promise(function(e,t){"interactive"!==document.readyState&&"complete"!==document.readyState||e(document.readyState),document.onreadystatechange=function(){~["interactive","complete"].indexOf(document.readyState)&&(e(document.readyState),document.onreadystatechange=null)}})}},{key:"renderView",value:function(e){var t=document.getElementById(this.settings.appId),n='<div id="'+this.settings.itemsId+'">'+this.templateItems(e)+'</div>\n                <button data-download><img src="spinner.gif">download</button>';t.innerHTML=n}},{key:"renderErrorView",value:function(e){var t=document.getElementById(this.settings.appId),n='<div class="error">Ups...something went wrong!\n                Try to visit this page later.<pre><code><strong>'+e.name+"</strong>\n"+e.message+"\n"+e.stack+"</code></pre></div>";t.innerHTML=n}},{key:"renderItems",value:function(e){document.getElementById(this.settings.itemsId).insertAdjacentHTML(this.settings.loadMode,this.templateItems(e))}},{key:"deleteItem",value:function(e){var t=e.elem;t.classList.toggle(this.settings.loadingClass);var n=t.parentNode.parentNode.parentNode;n.parentNode.removeChild(n),document.getElementById(this.settings.appId).lastElementChild.removeAttribute("disabled")}},{key:"templateItems",value:function(e){var t=this,n="";return e.forEach(function(e){n+=t.templateItem(e)}),n}},{key:"templateItem",value:function(e){return'<div class="item">\n              <img data-image="'+e.url+'" onload="lazyLoad(this)" src="spinner.gif" class="no-image"/>\n              <div class="flex">\n                <div class="content front"><span>'+e.title+'</span></div>\n                <div class="content back">\n                  <span>'+e.title.split(" ")[0]+"</span>\n                  <span>"+e.title+'</span>\n                  <button data-delete="'+e.id+'"><img src="spinner.gif">delete</button>\n                </div>\n              </div>\n            </div>'}}]),l);function l(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,e));return t.settings.loadMode="afterBegin",t}n.default=c},{"./Manager":4,"./config":10}],9:[function(e,t,n){"use strict";var r=e("./config");try{var o=r.storageManager.isEmpty()?r.loadManager.load():r.Promise.resolve(!1),i=r.viewManager.ready();r.Promise.all([o,i]).then(function(e){try{r.loadManager.notify("dataLoaded",e[0]),r.eventManager.setEventHandlers(r.storageManager),r.eventManager.notify("handlersReady",r.storageManager.restore())}catch(e){r.eventManager.notify("showError",e)}},function(e){r.eventManager.notify("showError",e)})}catch(e){r.eventManager.notify("showError",e)}},{"./config":10}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Promise=n.eventManager=n.storageManager=n.viewManager=n.loadManager=void 0;var r=u(e("./ObserverList")),o=u(e("./ViewManager")),i=u(e("./EventManager")),a=u(e("./LoadManagerJsonp")),s=u(e("./StorageManager"));function u(e){return e&&e.__esModule?e:{default:e}}var c=e("../../node_modules/es6-promise-polyfill/promise.min.js").Promise,l=new a.default(new r.default),f=new o.default(new r.default),d=new s.default(new r.default),p=new i.default(new r.default),h=[{instance:l,notifies:[{name:"dataLoaded",observers:[{instance:d,callback:d.save}]}]},{instance:p,notifies:[{name:"handlersReady",observers:[{instance:f,callback:f.renderView}]},{name:"showMore",observers:[{instance:f,callback:f.renderItems}]},{name:"showError",observers:[{instance:f,callback:f.renderErrorView}]},{name:"removeElem",observers:[{instance:d,callback:d.removeItemId},{instance:f,callback:f.deleteItem}]}]}];p.setObservers(h),n.loadManager=l,n.viewManager=f,n.storageManager=d,n.eventManager=p,n.Promise=c},{"../../node_modules/es6-promise-polyfill/promise.min.js":11,"./EventManager":1,"./LoadManagerJsonp":3,"./ObserverList":5,"./StorageManager":6,"./ViewManager":8}],11:[function(e,t,T){(function(e,j){!function(e){function n(){for(var e=0;e<O.length;e++)O[e][0](O[e][1]);g=!(O=[])}function r(e,t){O.push([e,t]),g||(g=!0,_(n,0))}function o(t){var e=(n=t.owner).state_,n=n.data_,r=t[e];if(t=t.then,"function"==typeof r){e=b;try{n=r(n)}catch(e){u(t,e)}}i(t,n)||(e===b&&a(t,n),e===w&&u(t,n))}function i(t,n){var r;try{if(t===n)throw new TypeError("A promises callback cannot return that same promise.");if(n&&("function"==typeof n||"object"==typeof n)){var e=n.then;if("function"==typeof e)return e.call(n,function(e){r||(r=!0,n!==e?a(t,e):s(t,e))},function(e){r||(r=!0,u(t,e))}),!0}}catch(e){return r||u(t,e),!0}return!1}function a(e,t){e!==t&&i(e,t)||s(e,t)}function s(e,t){e.state_===m&&(e.state_=v,e.data_=t,r(c,e))}function u(e,t){e.state_===m&&(e.state_=v,e.data_=t,r(l,e))}function t(e){var t=e.then_;for(e.then_=void 0,e=0;e<t.length;e++)o(t[e])}function c(e){e.state_=b,t(e)}function l(e){e.state_=w,t(e)}function f(e){if("function"!=typeof e)throw new TypeError("Promise constructor takes a function argument");if(!1==this instanceof f)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(e,t){function n(e){u(t,e)}try{e(function(e){a(t,e)},n)}catch(e){n(e)}}(e,this)}var d,p=e.Promise,h=p&&"resolve"in p&&"reject"in p&&"all"in p&&"race"in p&&(new p(function(e){d=e}),"function"==typeof d);void 0!==T&&T?(T.Promise=h?p:f,T.Polyfill=f):"function"==typeof define&&define.amd?define(function(){return h?p:f}):h||(e.Promise=f);function y(){}var g,m="pending",v="sealed",b="fulfilled",w="rejected",_=void 0!==j?j:setTimeout,O=[];f.prototype={constructor:f,state_:m,then_:null,data_:void 0,then:function(e,t){var n={owner:this,then:new this.constructor(y),fulfilled:e,rejected:t};return this.state_===b||this.state_===w?r(o,n):this.then_.push(n),n.then},catch:function(e){return this.then(null,e)}},f.all=function(s){if("[object Array]"!==Object.prototype.toString.call(s))throw new TypeError("You must pass an array to Promise.all().");return new this(function(n,e){function t(t){return i++,function(e){o[t]=e,--i||n(o)}}for(var r,o=[],i=0,a=0;a<s.length;a++)(r=s[a])&&"function"==typeof r.then?r.then(t(a),e):o[a]=r;i||n(o)})},f.race=function(o){if("[object Array]"!==Object.prototype.toString.call(o))throw new TypeError("You must pass an array to Promise.race().");return new this(function(e,t){for(var n,r=0;r<o.length;r++)(n=o[r])&&"function"==typeof n.then?n.then(e,t):e(n)})},f.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this(function(e){e(t)})},f.reject=function(n){return new this(function(e,t){t(n)})}}("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{timers:13}],12:[function(e,t,n){var r,o,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var c,l=[],f=!1,d=-1;function p(){f&&c&&(f=!1,c.length?l=c.concat(l):d=-1,l.length&&h())}function h(){if(!f){var e=u(p);f=!0;for(var t=l.length;t;){for(c=l,l=[];++d<t;)c&&c[d].run();d=-1,t=l.length}c=null,f=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function y(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new y(e,t)),1!==l.length||f||u(h)},y.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],13:[function(u,e,c){(function(e,t){var r=u("process/browser.js").nextTick,n=Function.prototype.apply,o=Array.prototype.slice,i={},a=0;function s(e,t){this._id=e,this._clearFn=t}c.setTimeout=function(){return new s(n.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new s(n.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(e){e.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},c.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},c._unrefActive=c.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},c.setImmediate="function"==typeof e?e:function(e){var t=a++,n=!(arguments.length<2)&&o.call(arguments,1);return i[t]=!0,r(function(){i[t]&&(n?e.apply(null,n):e.call(null),c.clearImmediate(t))}),t},c.clearImmediate="function"==typeof t?t:function(e){delete i[e]}}).call(this,u("timers").setImmediate,u("timers").clearImmediate)},{"process/browser.js":12,timers:13}]},{},[9]);